
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Setting up an OMA Browser &#8212; OMA Browser 2.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Documentation of the OMA Browser" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="setting-up-an-oma-browser">
<h1>Setting up an  OMA Browser<a class="headerlink" href="#setting-up-an-oma-browser" title="Permalink to this headline">¶</a></h1>
<p>There is a difference between a development environment setup and the production
setup. The first one is usually relatively simple to setup as it involves most often
only a Django server. In the following we explain how to setup the development
setup from basic to more complicated functions, intended to be run on a simple laptop
or dev host and finalize the section with the additioinal setup instructions
requried by the production site (which hosts also darwin and is capable to serve
many requests simultaniously).</p>
<div class="section" id="development-configuration">
<h2>Development configuration<a class="headerlink" href="#development-configuration" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Prepare a virtual environment for at least python3.4. You can do that best with pyenv.
details are available <a class="reference external" href="https://zoo.cs.ucl.ac.uk/doc/zoo/setup.html" title="(in zoo vlatest)"><span class="xref std std-doc">in the zoo documentation</span></a></li>
<li>clone the source of the pyomabrowser repo and install the dependencies:</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span>git clone ssh://gitolite@lab.dessimoz.org:2222/pyomabrowser
<span class="nb">cd</span> pyomabrowser
pip install -r requirements.txt
</pre></div>
</div>
<ul class="simple">
<li>The next step is that you need a hdf5 database instance. There are several options how
you could obtain or refer to one.<ul>
<li>a basic test db is accessible from the public OMA Browser:
<a class="reference external" href="http://omabrowser.org/All/Test.OmaServer.h5">http://omabrowser.org/All/Test.OmaServer.h5</a>. This database is useful if you want
to play around on your laptop and don’t have a lot of disc space available. Once you
downloaded the file, rename it to OmaServer.h5 and either place it into the pyomabrowser
repo or set the environment variable DARWIN_BROWSERDATA_PATH to the folder where you
downloaded the file to, e.g. <code class="code sh docutils literal"><span class="name builtin"><span class="pre">export</span></span> <span class="name variable"><span class="pre">DARWIN_BRWOSERDATA_PATH</span></span><span class="operator"><span class="pre">=</span></span><span class="pre">/path/to/download/folder</span></code></li>
<li>alternatively, you can copy the big file to you laptop. it is available on the
cs and ucl shared space under /oma-{browser,server}/&lt;release&gt;/data/OmaServer.h5.
The file is quite big (&gt;50GB). procede afterwards as with the above.</li>
<li>the last option is to mount the filesystem via sshfs and directly point with your
DARWIN_BRWOSERDATA_PATH to the path where the file exists. This is handy, but requires
a very fast connection and will probably break the async computation functionalities like
the msa or marker gene export.</li>
</ul>
</li>
</ul>
<p>Now, you are ready to start your server locally using the django ‘runserver’ command.
If you are not familiar with <a class="reference external" href="https://www.djangoproject.com/">Django</a>, have a careful
ready about it and consider doing their <a class="reference external" href="https://docs.djangoproject.com">introduction tutorial</a>.
Essentially, you can start the service with</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>python manage.py migrations
python manage.py runserver --nothreading
</pre></div>
</div>
<p>and access the instance in your web browser on <a class="reference external" href="http://localhost:8000">http://localhost:8000</a>.</p>
<div class="section" id="advanced-features">
<h3>Advanced features<a class="headerlink" href="#advanced-features" title="Permalink to this headline">¶</a></h3>
<p>To be able to test the asynchronous features you need to install rabbitmq on your machine
using homebrew or apt package manager. The omabrowser will connect as guest on localhost
by default, so you don’t have to configure any users there. Make sure rabbitmq-server is
running either by starting it manually or as service in the background.</p>
<p>Then you need to start at least one celery process that does the async work. You can do
that by running to following commands in the pyomabrowser root folder:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>celery worker -A pybrowser_dev --pool<span class="o">=</span>solo --loglevel<span class="o">=</span>DEBUG
</pre></div>
</div>
<p>The pool=solo is needed on macos only. obviously, you can play with the loglevel parameter.</p>
</div>
</div>
<div class="section" id="production-site-configuration">
<h2>Production site configuration<a class="headerlink" href="#production-site-configuration" title="Permalink to this headline">¶</a></h2>
<p>The main omabrowser instance has a python and darwin backend. Both are served from</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Setting up an  OMA Browser</a><ul>
<li><a class="reference internal" href="#development-configuration">Development configuration</a><ul>
<li><a class="reference internal" href="#advanced-features">Advanced features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#production-site-configuration">Production site configuration</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Documentation of the OMA Browser</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/setup.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, DessimozLab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/setup.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>