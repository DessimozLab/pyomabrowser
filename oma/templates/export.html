{% extends  "core.html" %}
{% load staticfiles %}
{% load bootstrap3 %}
{% block title %}OMA orthology database: Export for OMA Standalone{% endblock %}
{% block meta_description %}Export genomes and precomputed all-against-all results for OMA standalone. {% endblock %}

{% block css_hook %}
<link type="text/css" rel="stylesheet" href="{% static "css/phylotree.css" %}"/>
<link type="text/css" rel="stylesheet" href="{% static "css/typeaheadjs.css" %}"/>
<link type="text/css" rel="stylesheet" href="{% static "css/treecompare.css" %}"/>
{% endblock css_hook %}
{% block js_hook %}
{% if max_nr_genomes %}<script type="text/javascript">MAX_NR_GENOMES = {{ max_nr_genomes }}; </script>{% endif %}
<script src="https://use.fontawesome.com/28dcb2432d.js"></script>
<script src="{% static "js/underscore-min.js" %}"></script>
<script src="{% static "js/canvas-toBlob.js" %}"></script>
<script src="{% static "js/FileSaver.min.js" %}"></script>
<script src="{% static "js/treecompare.js" %}"></script>
<script src="{% static "js/phylotree.js" %}"></script>
<script src="{% static "js/d3.v3.min.js" %}"></script>
<script src="{% static "js/typeahead.bundle.js" %}"></script>
{% endblock js_hook %}


{% block content %}
<div class="container-fluid">
    {% block above_svg %}{% endblock %}
    <div class="row">       
        <div class="col-md-9" id="svgdiv" style="overflow: hidden;"> <!-- svg -->
            <div id="phylo_io" style="overflow: hidden;overflow-x:scroll;" >
                <button class="btn btn-lg" data-toggle="modal" data-target="#myModal" id="modalhelp">
                    <span class="glyphicon glyphicon-question-sign"></span>
                </button>
                <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                <h4 class="modal-title" id="myModalLabel">{% block modal_title %}Export of genomes and All/All for OMA standalone{% endblock modal_title %}</h4>
                            </div>
                            <div class="modal-body">
                                {% block modal_body %}
                                <p>In order to simplify analysis of customized genomes using the OMA Standalone application, we provide here users with precomputed all-against-all results, i.e. the most time-consuming part of the OMA pipeline. Users can simply augment the dataset with their new genomes and only the new genome-pairs will have to be aligned.</p>
                                <p> <b>Important limitations and notices</b> </p>
                                <ul>
                                    <li><p>Note that for OMA we only store pairwise matches of alignments with a Smith-Waterman score of at least 130 and where the alignment extends over at least 30% of the smaller sequence. If you need more relaxed parameters, you will have to do the alignments again from scratch.</p></li>
                                    <li><p>The selected genomes cannot be modified. Do not try to add, remove or change any sequences. The changes will not get incorporated, but might invalidate any later inference due to indexing mistakes.</p></li>
                                </ul>
                                {% endblock modal_body %}
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                <button class="btn btn-primary " data-toggle="modal" data-target="#myModaltuto">
                                    How to use the genome-picker 
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal fade" id="myModaltuto" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                <h4 class="modal-title" id="myModalLabel2">How to use the genome-picker ?</h4>
                            </div>
                            <div class="modal-body">
                                <img src="{%static "image/help_export.png" %}" class="img-responsive margin-auto" alt="OMA genomepicker how to use">
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal"> <span class="glyphicon glyphicon-chevron-left"></span> Back</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3" id="row3"> <!-- UI -->
            <div class="row">
                <div class="col-md-12" style="margin-bottom: 15px;">

                    <div id="UISelected" class="panel panel-default">
                        <div class="panel-heading" id="UISelectedHeading">
                            <h3 class="panel-title text-center searchg" id="textSel" style="font-size: 18px; color: #307C3B;" >Selected genomes</h3>
                        </div>
                        <div class="panel-body" id="UISelectedContent" style="padding: 0;">
                        </div>
                    </div>

                </div>
                {% block menu_additional_inputs %}{% endblock %}
                <div class="col-md-12" id="buttondiv">
                        <div class="col-sm-6 col-md-6">
                            <button style="background-color: #307C3B; color: #fff;" type="button" class="btn btn-default btn-block greenb" id="buttonUnselect">Unselect all</button>
                        </div>
                        <div class="col-sm-6 col-md-6">
                            <button style="background-color: #307C3B; color: #fff;" type="submit" class="btn btn-default btn-block greenb" id="{% block submit_button_id %}buttonSubmit{% endblock %}">Submit</button>
                        </div>
                    </div>
                </div>
            </div> <!-- /UI -->
        </div>  
    </div>
</div>
{% endblock content %}
