{% extends "seqCV.html" %}
{% load staticfiles %}

{% block title %}OMA orthology database: Pairwise Orthologs for {{ entry.omaid }}{% endblock %}
{% block meta_description %}For {{ entry.omaid }} OMA predicts the following {{ vps|length }} pairwise orthologs{% endblock %}
{% block contentTab %}

<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
				<h3 id="myModalLabel">The OMA Browser reports for every entry different types of orthology</h3>
			</div>
			<div class="modal-body">
				{% include "includes/otypes.html" %}
			</div>
		</div>
	</div>
</div>


<div class="panel panel-default">
    <div class="panel-heading clearfix">
        <div class="pull-left">
            Pairwise Orthologs <a href="#" class="badge" role="button" data-toggle="modal" data-target=".bs-example-modal-lg">?</a>
        </div>
        <div class="pull-right">
            Download:
            <a href="{% url 'pairs_fasta' entry.omaid %}"><span class="glyphicon glyphicon-download">Fasta</span></a>
        </div>
    </div>
    <div class="panel-body">
        {% regroup vps by reltype as vps_grouped %}
        <ul class="nav nav-pills" role="tablist">
        {% for one_rel_vps in vps_grouped %}
            <li role="presentation" class="{% if forloop.first %}active{% endif %}" role="tab">
                <a href="#rels{{ forloop.counter }}" data-toggle="tab">{{ one_rel_vps.grouper }}</a></li>
        {% endfor %}
        </ul>
        <div class="tab-content">
        {% for one_rel_vps in vps_grouped %}
            <div role="tabpanel" class="tab-pane {% if forloop.first %}active{% endif %}" id="rels{{ forloop.counter }}">
                <table class="table table-hover">
                    <thead><tr><td class="col-md-3">Taxon</td><td class="col-md-2">Protein ID</td>
                               <td class="col-md-2">Cross reference</td><td class="col-md-3">Domain Architectures</td></tr></thead>
                    <tbody>
                        {% for vp in one_rel_vps.list %}
                        <tr class="protein" id="{{ vp.omaid }}">
                            <td>{% include "includes/kingdom.html" with kingdom=vp.genome.kingdom %} <b>{{vp.genome.species}}</b>{{vp.genome.strain}} </td>
                            <td><a href="{% url "pairs" vp.omaid %}">{{vp.omaid}}</td>
                            <td><a class="external" href="">{{ vp.canonicalid }}</a></td>
                            <td class="domain_vis"></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% endfor %}
        </div>

    </div>
</div>
<!-- D3 and D3 Tooltip -->
<script src="{% static "js/d3.v3.min.js" %}" type="text/javascript"></script>
<script src="{% static "js/d3.tip.v0.6.3.js" %}" type="text/javascript"></script>
<!-- Domain Visualisation -->
<script src="{% static "js/domains_vis.js" %}" type="text/javascript"></script>
<link href="{% static "css/domains_vis.css" %}" rel="stylesheet" type="text/css" />
<script>
(function () {
    var domains = domain_vis();
    domains(".protein", {{ longest_seq }});
}())
</script>
{% endblock contentTab %}
