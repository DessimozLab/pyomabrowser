{% extends  "core.html" %}
{% load staticfiles %}
{% load bootstrap3 %}

{% block title %}Synteny dot plot viewer{% endblock %}

{% block content %}


    <div class="container-fluid" >

        <div class="row">

            <div class="col-sm-12 col-md-10 col-md-offset-1">


                <div id="dotplot_container" >

                    <div class="text-center">

                        <div >

                            <button id='btn_display_settings' class="btn btn-xs" style="float: right; margin: 0 0 10px 10px;" aria-label="Left Align"  data-toggle="collapse" data-target="#collapseSettings" aria-expanded="false" aria-controls="collapseSettings" type="button"  >
                                OPTIONS
                                <span id="icon_settings" class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
                            </button>

                            <h4> <b>{{ genome1 }} chromosome {{ chromosome1 }}</b>
                                <em>versus</em> <b>{{ genome2 }} chromosome {{ chromosome2 }} </b></h4>

                        </div>


                        <div>

                            <div id="hogvis_settings">


                                <div class="collapse" id="collapseSettings"><br>


                                    <div id="button-settings-div">


                                        <div class="btn-group">
                                            <button class="btn btn-default btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <b>Action on brush</b> <span class="caret"></span>
                                            </button>

                                            <ul id="action_dropdown" class="dropdown-menu">
                                                <li class="action_dropdown-li" id="ba-zoom"><a> Zoom in</a> </li>
                                                <li class="action_dropdown-li" id="ba-select"><a> Select </a> </li>
                                            </ul>
                                        </div>

                                        <div class="fakebutton"> <b>Remove pairs with distance greater than
                                            <input id="min_distance_setting_id" class='min_distance_setting'type="number" step="0.5" value="0" min="0" max="100"></b>
                                        </div>

                                    </div>
                                </div>
                            </div>

                        </div>

                        <script>

                            (function(){
                                document.getElementById("btn_display_settings").addEventListener("click", function(){
                                    var ico = document.getElementById("icon_settings");
                                    if (ico.getAttribute("class") === "glyphicon glyphicon-triangle-top") {ico.setAttribute("class","glyphicon glyphicon-triangle-bottom")}
                                    else ico.setAttribute("class","glyphicon glyphicon-triangle-top");
                                });
                            }) ();
                        </script>


                    </div>

                    <hr>

                </div>

                <div id="container_table_selection">

                    <table id="table_selection"></table>


                </div>


            </div>


        </div>

    </div>

    </div>

    <!-- D3 and D3 Tooltip -->
    <script src="//d3js.org/d3.v4.min.js" type="text/javascript"></script>

    <!-- bootstrap-table -->
    <script src="{% static "js/tablehooks.js" %}" type="text/javascript"></script>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.0/bootstrap-table.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.0/bootstrap-table.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.0/extensions/filter-control/bootstrap-table-filter-control.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.0/extensions/export/bootstrap-table-export.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.0/extensions/mobile/bootstrap-table-mobile.min.js"></script>
    <script src="{% static "js/tableExport.min.js" %}"></script>


    <link href="{% static "css/synteny_dotplot.css" %}" rel="stylesheet" type="text/css"/>
    <script src="{% static "js/synteny_dotplot.js" %}" type="text/javascript"></script>


    <script>

        (function () {


            //var url_json = "/All/dotplot_example.json";
            //var url_json = "/All/mouse10_vs_human10.json";
            //var url_json = "/All/mouse2_vs_human2.json";
            var url_json = "/All/arath1_vs_araly1.json";
            var container = "dotplot_container";

            var genome1 = "{{ genome1 }}";
            var genome2 = "{{ genome2 }}";

            var chromosome1 = "{{ chromosome1 }}";
            var chromosome2 = "{{ chromosome2 }}";

            var DotPlot = dotplot_theme();


            var correct_url = "/oma/syntenyDP/" + genome1 +"/" + genome2 +"/" + chromosome1.replace(/\s/g,"%20") + "/" + chromosome2.replace(/\s/g,"%20") + "/json/" ;

            console.log(correct_url);

            var dotplot = new DotPlot(container,url_json, genome1,genome2,chromosome1,chromosome2);


            $('#table_selection').bootstrapTable({
                reorderableColumns: true,
                pagination: true,
                pageSize: 10,
                showColumns: true,
                search: true,
                showExport: true,
                pageList: [10, 25, 50, 100, "All"],
                mobileResponsive: true,
                checkOnInit: true,
                undefinedText: "",
                showToggle: 'true',
                columns: [{
                    field: 'distance',
                    title: 'Distance'
                }, {
                    field: 'gene1',
                    title: genome1 + ' gene'
                }, {
                    field: 'gene2',
                    title: genome2 + ' gene'
                }]
            });

            $('#container_table_selection').hide()

        }) ();

    </script>



{% endblock content %}







