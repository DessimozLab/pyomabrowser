{% extends "seqCV.html" %}
{% load staticfiles %}

{% block title %}OMA: Hierarchical Orthologous Groups for {{ fam.id }}{% endblock %}
{% block meta_description %}Hierarchical orthologous groups (HOGs) provide a set of genes that have all started diverging from a single ancestral gene at the taxonomic range of interest.{% endblock %}
{% block js_hook %}
    <!-- D3 -->
    <!--<script src="{% static "js/d3.v3.min.js" %}" charset="utf-8"></script>-->
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="http://benschmidt.org/colorbar/colorbar.js" charset="utf-8"></script>

    <!-- Underscore -->
    <script src="{% static "js/underscore-min.js" %}"></script>

    <!-- TnT -->
    <link rel="stylesheet" href="{% static "css/tnt.css" %}" type="text/css" />
    <link rel="stylesheet" href="{% static "css/hog.css" %}" type="text/css" />
    <link rel="stylesheet" href="http://tntvis.github.io/tnt.tooltip/build/tnt.tooltip.css" type="text/css" />
    <script src="http://tntvis.github.io/tnt/build/tnt.min.js" charset="utf-8"></script>
    <script src="http://tntvis.github.io/tnt.tooltip/build/tnt.tooltip.min.js" charset="UTF-8"></script>
    <script src="{% static "js/hog.js" %}" charset="UTF-8"></script>

{% endblock %}

{% block contentTab %}

    <div  style="background-color: white; padding:10px;">

        {% if isSingleton %}This entry is not part of any hierarchical orthologous group.

        {% else %}

            <div id="hogvis">

                <div id="header">

                    <div id="gap_conpenser"> </div>

                    <div id="hogvisheader">

                        <div>

                            <button id='btn_display_settings' class="btn btn-default" style="float: right; margin: 0 0 10px 10px;" aria-label="Left Align"  data-toggle="collapse" data-target="#collapseSettings" aria-expanded="false" aria-controls="collapseSettings" type="button"  >
                                OPTIONS
                                <span id="icon_settings" class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
                            </button>

                            <h3 >Hierarchical group {{ fam.id }} open at level of <span id="current_level_text" style="font-weight:bold;"></span> </h3>

                        </div>

                        <div id="hogvis_settings">


                            <div class="collapse" id="collapseSettings">

                                <div id="button-settings-div">

                                    <div class="btn-group">
                                        <button class="btn btn-default btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> Select Color Scheme <span class="caret"></span>
                                        </button>

                                        <ul id="genedata-vis" class="dropdown-menu">
                                        </ul>

                                    </div>

                                    <div class="btn-group">
                                        <button class="btn btn-default btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> Show tooltips on <span class="caret"></span>
                                        </button>

                                        <ul id="tooltip_dropdown" class="dropdown-menu">
                                            <li class="tooltip_dropdown-li" id="gt-click"><a> Click</a> </li>
                                            <li class="tooltip_dropdown-li" id="gt-mousover"><a> Mouseover </a> </li>
                                        </ul>
                                    </div>

                                    <button type="button" class="btn btn-default btn-sm" disabled="disabled">Remove Low Confidence Columns</button>

                                </div>

                                <div id="scale-settings-div">
                                    <div class="scale-item" id="colorbarText" > </div>
                                    <div class="scale-item" id="colorbar" > </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <script>

                        (function(){
                            document.getElementById("btn_display_settings").addEventListener("click", function(){
                                var ico = document.getElementById("icon_settings");
                                if (ico.getAttribute("class") === "glyphicon glyphicon-triangle-top") {ico.setAttribute("class","glyphicon glyphicon-triangle-bottom")}
                                else ico.setAttribute("class","glyphicon glyphicon-triangle-top");
                            });
                        }) ();
                    </script>

                </div>

            </div>

            <script>

                (function () {

                    var Hogvis = hog_theme();

                    var tree = {{ species_tree|safe }};
                    var query = {'id': {{ entry.entry_nr }} };
                    var per_species = {{ per_species|safe }};
                    var tooltip_data = {{ xrefs|safe }};
                    var hogvis_container_id = "hogvis";

                    var genedatavis = [{
                        name: 'Query Gene',
                        scale: 'on_off'
                    },
                        {
                            name: "Gene Length",
                            scale: "linear",
                            field: "sequence_length",
                            func: "color1d"
                        }
                    ];

                    var default_options = {
                        label_height: 20,
                        genedatavis: genedatavis};

                    var hogvis = new Hogvis(hogvis_container_id, query, per_species,
                        tree, tooltip_data, default_options , document.getElementById("genedata-vis")  );

                }) ();

            </script>

        {% endif %}

    </div>

{% endblock %}